!function(a,b){"object"==typeof exports?module.exports=b(require("underscore"),require("backbone.epoxy")):"function"==typeof define&&define.amd?define(["underscore","backbone.epoxy"],b):a.BBCustoms=b(a.underscore,a.Backbone.Epoxy)}(this,function(a,b){var c,d,e,f,g,h,i;return c={isEmpty:function(a){if("[object Array]"===Object.prototype.toString.call(a))return a.length>0;for(var b in a)if(a.hasOwnProperty(b))return!1;return!0},tmpl:function(a,b){return a.replace(/{([^{}]*)}/g,function(a,c){return"string"==typeof b[c]?b[c]:a})}},d=function(a){var b={numeric:/^[0-9]+$/,integer:/^\-?[0-9]+$/,decimal:/^\-?[0-9]*\.?[0-9]+$/,email:/^[a-zA-Z0-9.!#$%&amp;'*+\-\/=?\^_`{|}~\-]+@[a-zA-Z0-9\-]+(?:\.[a-zA-Z0-9\-]+)*$/,alpha:/^[a-z]+$/i,alphaNumeric:/^[a-z0-9]+$/i,alphaDash:/^[a-z0-9_\-]+$/i,natural:/^[0-9]+$/i,naturalNoZero:/^[1-9][0-9]*$/i,ip:/^((25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})\.){3}(25[0-5]|2[0-4][0-9]|1[0-9]{2}|[0-9]{1,2})$/i,base64:/[^a-zA-Z0-9\/\+=]/i,numericDash:/^[\d\-\s]+$/,url:/^(https?|s?ftp):\/\/(((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:)*@)?(((\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5])\.(\d|[1-9]\d|1\d\d|2[0-4]\d|25[0-5]))|((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?)(:\d*)?)(\/((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)+(\/(([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)*)*)?)?(\?((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|[\uE000-\uF8FF]|\/|\?)*)?(#((([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(%[\da-f]{2})|[!\$&'\(\)\*\+,;=]|:|@)|\/|\?)*)?$/i},c={};return c.required={msg:"The {0} field is required.",check:function(b){return null!==b&&"object"==typeof b?a.isEmpty(b):null!==b&&""!==b}},c["default"]={msg:"The {0} field is still set to default, please change.",check:function(a,b){return a!==b}},c.email={msg:"The {0} field must contain a valid email address.",check:function(a){return b.email.test(a)}},c.emails={msg:"The {0} field must contain all valid email addresses.",check:function(a){for(var c=a.split(","),d=0;d<c.length;d++){var e=String(c[d]).replace(/^\s+|\s+$/g,"");if(!b.email.test(e))return!1}return!0}},c.minLength={msg:"The {0} field must be at least {1} characters in length.",check:function(a,c){return b.numeric.test(c)?a.length>=parseInt(c,10):!1}},c.maxLength={msg:"The {0} field must not exceed {1} characters in length.",check:function(a,c){return b.numeric.test(c)?a.length<=parseInt(c,10):!1}},c.exactLength={msg:"The {0} field must be exactly {1} characters in length.",check:function(a,c){return b.numeric.test(c)?a.length===parseInt(c,10):!1}},c.greaterThan={msg:"The {0} field must contain a number greater than {1}.",check:function(a,c){return b.decimal.test(a)?parseFloat(a)>parseFloat(c):!1}},c.lessThan={msg:"The {0} field must contain a number less than {1}.",check:function(a,c){return b.decimal.test(a)?parseFloat(a)<parseFloat(c):!1}},c.alpha={msg:"The {0} field must only contain alphabetical characters.",check:function(a){return b.alpha.test(a)}},c.alphaNumeric={msg:"The {0} field must only contain alpha-numeric characters.",check:function(a){return b.alphaNumeric.test(a)}},c.alphaDash={msg:"The {0} field must only contain alpha-numeric characters, underscores, and dashes.",check:function(a){return b.alphaDash.test(a)}},c.numeric={msg:"The {0} field must contain only numbers.",check:function(a){return b.numeric.test(a)}},c.integer={msg:"The {0} field must contain an integer.",check:function(a){return b.integer.test(a)}},c.decimal={msg:"The {0} field must contain a decimal number.",check:function(a){return b.decimal.test(a)}},c.natural={msg:"The {0} field must contain only positive numbers.",check:function(a){return b.natural.test(a)}},c.naturalNoZero={msg:"The {0} field must contain a number greater than zero.",check:function(a){return b.naturalNoZero.test(a)}},c.url={msg:"The {0} field must contain a valid URL.",check:function(a){return b.url.test(a)}},c.creditCard={msg:"The {0} field must contain a valid credit card number.",check:function(a){if(!b.numericDash.test(a))return!1;for(var c=a.replace(/[ -]+/g,""),d=c.length,e=0,f=0,g=[[0,1,2,3,4,5,6,7,8,9],[0,2,4,6,8,1,3,5,7,9]];d--;)f+=g[e][parseInt(c.charAt(d),10)],e^=1;return f%10===0&&f>0}},c.fileType={msg:"The {0} field must contain only {1} files.",check:function(a,b){for(var c=a.substr(a.lastIndexOf(".")+1),d=b.split(","),e=0;e<d.length;e++){var f=String(d[e]).replace(/^\s+|\s+$/g,"");if(c===f)return!0}return!1}},c}(c),e=function(a,b){var c=function(){this.isValid=!0,this.errors={}};return c.prototype.run=function(a,b){for(var c in a)b[c]&&this.checkRules(c,a[c],b[c])},c.prototype.checkRules=function(a,b,c){var d=[],e=""===b,f=c[0];if(e&&f&&"required"!==c[0].name)return!0;for(var g in c){var h=this.checkRule(a,b,c[g]);h&&d.push(h)}d.length&&(this.errors[a]=d)},c.prototype.checkRule=function(a,c,d){if(!b[d.name])throw new Error("There is no check defined by the name: "+d.name);return b[d.name].check(c,d.args)?null:this.formatError(a,d)},c.prototype.formatError=function(c,d){this.isValid=!1;var e=b[d.name].msg,f=[c];return d.args&&(f=f.concat([d.args])),{name:d.name,msg:a.tmpl(e,f)}},c}(c,d),f=function(a){var b=function(a){this.rules=this.build(a)};return b.prototype.build=function(a){var b={};for(var c in a)b[c]=this.buildRules(a[c]);return b},b.prototype.buildRules=function(a){for(var b=a.split("|"),c=[],d=0,e=b.length;e>d;d++){var f=this.parseRule(b[d]),g="required"===f.name?"unshift":"push";c[g](f)}return c},b.prototype.parseRule=function(a){var b=/^(.+?)\[(.+)\]$/.exec(a);return b?{name:b[1],args:b[2]}:{name:a}},b.prototype.check=function(b){var c=new a;return c.run(b,this.rules||{}),{isValid:c.isValid,errors:c.errors}},b}(e),g=function(a,b,c){return a.extend(b.View.mixin(),{validate:function(b,d){if(b=b||this.toJSON(),d=d||{},!this.validator||d.customs){var e=d.customs||{},f=this.customs||{},g=a.extend(e,f);this.validator=new c(g)}var h=this.validator.check(b);return h.isValid?void 0:(this._handleValidation(b,h.errors),h.errors)},_handleValidation:function(a,b){for(var c in a)b[c]?(this.validationError=this.validationError||{},this.validationError[c]=b[c],this.trigger("invalid:attribute",c,b[c])):this.trigger("valid:attribute",c)}})}(a,b,f),h=function(a,b){return a.extend(b.View.mixin(),{initCustoms:function(){a.isObject(this.bindings)||(this.bindings={},this._create()),this.applyBindings()},_create:function(){var a={other:'input[type!="radio"][type!="checkbox"], textarea',radio:'input[type="radio"]',check:'input[type="checkbox"]',select:"select"};for(var b in a)this._bindElements(b,a[b])},_bindElements:function(b,c){this.$el.find(c).each(a.bind(function(a,c){this._bindElement(b,c)},this))},_bindElement:function(a,b){var c=b.name,d=this.model.attributes,e=d[c];e||(d[c]=this["_"+a+"Default"](b)),this["_"+a+"Bind"](b)},_selector:function(a,b){return"["+a+'="'+b+'"]'},_optionBind:function(a){var b=a.name,c=a.value,d=this._selector("name",b),e=this._selector("value",c);this.bindings[d+e]="checked:"+b},_basicBind:function(a){var b=a.name,c=this._selector("name",b);this.bindings[c]="value:"+b+',events:["keyup"]'},_otherDefault:function(a){return a.value||""},_otherBind:function(a){this._basicBind(a)},_radioDefault:function(a){var b=a.name,c=this._selector("name",b)+":checked",d=this.$el.find(c).val();return d||""},_radioBind:function(a){this._optionBind(a)},_checkDefault:function(a){var b=a.name,c=this._selector("name",b)+":checked",d=[];return this.$el.find(c).each(function(){d.append(this.value)}),d},_checkBind:function(a){this._optionBind(a)},_selectDefault:function(a){var b=$(a).find(":selected")[0];return b.value||b.text},_selectBind:function(a){this._basicBind(a)}})}(a,b),i=function(a,b){return{model:a,view:b}}(g,h)});